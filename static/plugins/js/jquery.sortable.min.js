(function(o){var h,l=o();o.fn.sortable=function(s){var d=String(s);s=o.extend({connectWith:false,placeholderClass:""},s);return this.each(function(){if(/^enable|disable|destroy$/.test(d)){var e=o(this).children(o(this).data("items")).attr("draggable",d=="enable");if(d=="destroy"){e.add(this).removeData("connectWith items").off("dragstart.h5s dragend.h5s selectstart.h5s dragover.h5s dragenter.h5s drop.h5s")}return}var r,a,i,t=o(this).children(s.items);var n=o("<"+(/^ul|ol$/i.test(this.tagName)?"li":/^tbody$/i.test(this.tagName)?"tr":"div")+' class="sortable-placeholder '+s.placeholderClass+'">').html("&nbsp;");t.find(s.handle).mousedown(function(){r=true}).mouseup(function(){r=false});o(this).data("items",s.items);l=l.add(n);if(s.connectWith){o(s.connectWith).add(this).data("connectWith",s.connectWith)}t.attr("draggable","true").on("dragstart.h5s",function(e){if(s.handle&&!r){return false}r=false;var t=e.originalEvent.dataTransfer;t.effectAllowed="move";t.setData("Text","dummy");i=(h=o(this)).addClass("sortable-dragging").index();a=h.parent()}).on("dragend.h5s",function(){if(!h){return}h.removeClass("sortable-dragging").show();l.detach();if(i!=h.index()){h.parent().trigger("sortupdate",{item:h})}if(!h.parent().is(a)){h.parent().trigger("sortconnect",{item:h})}h=null}).not("a[href], img").on("selectstart.h5s",function(){this.dragDrop&&this.dragDrop();return false}).end().add([this,n]).on("dragover.h5s dragenter.h5s drop.h5s",function(e){if(!t.is(h)&&s.connectWith!==o(h).parent().data("connectWith")){return true}if(e.type=="drop"){e.stopPropagation();l.filter(":visible").after(h);h.trigger("dragend.h5s");return false}e.preventDefault();e.originalEvent.dataTransfer.dropEffect="move";if(t.is(this)){if(s.forcePlaceholderHeight||s.forcePlaceholderSize){n.height(h.outerHeight())}if(s.forcePlaceholderWidth||s.forcePlaceholderSize){n.width(h.outerWidth())}h.hide();o(this)[n.index()<o(this).index()?"after":"before"](n);l.not(n).detach()}else if(!l.is(this)&&!o(this).children(s.items).length){l.detach();o(this).append(n)}return false})})}})(jQuery);