{% set active_page = "corpus" %}
{% include "header.html" %}
<div class="container-fluid p-3">
    <div class="d-flex flex-row">
        <div id="corpus-column">
            <span id="corpus-title" class="lead"></span>
            <table id="corpus_viewer" class="table table-bordered table-hover" data-toggle="table"
                data-url="{{url_for('api_chapter', chapter_id=data.chapter_id)}}"
                data-response-handler="response_handler"
                data-toolbar="#corpus-title"
                data-unique-id="verse_id"
                data-cache="false"
                data-search="true"
                data-search-highlight="true"
                data-show-refresh="true"
                data-show-columns="true"
                data-pagination="true"
                data-page-list="[10, 20, 50, 100, All]"
                data-show-jump-to="true"
                data-show-jump-to-by-pages="10"
                data-click-to-select="true"
                data-detail-view="true"
                data-detail-view-icon="false"
                data-detail-formatter="{{config.row_detail_formatter}}_row_detail_formatter"
                data-row-attributes="row_attribute_handler"
                data-sticky-header="true"
                data-sticky-header-offset-left="0"
                data-sticky-header-offset-right="0">
                <thead>
                    <tr>
                        <th scope="col" data-field="edit" data-radio="true"></th>
                        <!-- <th scope="col" data-field="line_id" data-sortable="true">
                            Line
                        </th> -->
                        <th scope="col" data-field="verse_id">
                            Verse
                        </th>
                        <th scope="col" data-field="text" data-formatter="column_text_formatter">
                            Text
                        </th>
                        <th scope="col" title="Progress" data-field="progress" data-align="center" data-formatter="column_progress_formatter">
                            <i class="fa fa-list-check"></i>
                        </th>
                    </tr>
                </thead>
            </table>
        </div>
        <div id="annotation-column" class="sticky-top align-self-start">
            <!-- For "sticky-top" to work on a "col" element requires "align-self-start" class as well. -->
            <!-- <div class="scroll-large"> -->
            {% if current_user.has_permission("annotate") %}
            <ul class="nav nav-pills mb-3" id="pills-tab" role="tablist">
                {% for task in constants.tasks %}
                {% if task.id == 1 %}
                    {% set active_class = "active" %}
                    {% set aria_selected = "true" %}
                {% else %}
                    {% set active_class = "" %}
                    {% set aria_selected = "false" %}
                {% endif %}
                <li class="nav-item" title="{{task.title}}">
                  <a class="nav-link {{active_class}}" id="task-{{task.id}}-tab" data-task="{{task.name}}" data-toggle="pill" href="#task-{{task.id}}-tab-content" role="tab" aria-controls="task-{{task.id}}-tab-content" aria-selected="{{aria_selected}}">{{task.short}}</a>
                </li>
                {% endfor %}
            </ul>

            <div class="tab-content" id="pills-tab-content">
                {% for task in constants.tasks %}
                {% if task.id == 1 %}
                    {% set active_class = "active" %}
                {% else %}
                    {% set active_class = "" %}
                {% endif %}
                <div class="tab-pane {{active_class}}" id="task-{{task.id}}-tab-content" role="tabpanel" aria-labelledby="task-{{task.id}}-tab">
                    {% include "task_" + task.name + ".html" %}
                </div>
                {% endfor %}
            </div>

            {% endif %}
            <!-- </div> -->
        </div>
    </div>
</div>
<!-- Add Token Modal -- BEGIN -->
<div class="modal fade" id="add-token-modal" tabindex="-1" aria-labelledby="add-token-modal-label" aria-hidden="true">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="add-token-modal-label">Add Token</h5>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <div class="modal-body">
                <form id="add-token-form">
                    <div class="row">
                        <div class="col-sm">
                            <legend>Mandatory</legend>
                            <table class="table">
                                <tr>
                                    <td>Text</td>
                                    <td><input type="text" class="form-control" name="token-text" id="add-token-input-text" placeholder="Text" required></td>
                                </tr>
                                <tr>
                                    <td>Lemma</td>
                                    <td><input type="text" class="form-control" name="token-lemma" id="add-token-input-lemma" placeholder="Lemma" required></td>
                                </tr>
                            </table>
                            <legend>Analysis</legend>
                            <table class="table">
                                {% for analysis_item in config.token_analysis_items %}
                                <tr class="add-token-analysis-item">
                                    <td class="add-token-analysis-label">{{analysis_item.title}}</td>
                                    <td><input type="text" class="form-control add-token-analysis-input" name="token-analysis-{{analysis_item.id}}" id="add-token-input-analysis-{{analysis_item.id}}" placeholder="{{analysis_item.title}}"></td></td>
                                </tr>
                                {% endfor %}
                            </table>
                        </div>
                        <div class="col-sm scroll-medium">
                            <legend>Features</legend>
                            <table class="table">
                                {% for feature_item in config.token_feature_items %}
                                <tr class="add-token-feature-item">
                                    <td class="add-token-feature-label">{{feature_item.title}}</td>
                                    <td><input type="text" class="form-control add-token-feature-input" name="token-feats-{{feature_item.id}}" id="add-token-input-feats-{{feature_item.id}}" placeholder="{{feature_item.title}}"></td></td>
                                </tr>
                                {% endfor %}
                            </table>
                        </div>
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-dismiss="modal">Cancel</button>
                <button id="add-token" type="button" class="btn btn-primary">Add</button>
            </div>
        </div>
    </div>
</div>
<!-- Add Token Modal -- END -->
<!-- Show Graph Modal -- BEGIN -->
<div class="modal fade" id="show-graph-modal" tabindex="-1" aria-labelledby="show-graph-modal-label" aria-hidden="true">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="show-graph-modal-label"></h5>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <div class="modal-body">
                <div class="container-fluid px-0">
                    <div class="border rounded px-2 py-1" id="graph" style="height: 55vh;">
                        No edges have been added yet.
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <button id="snapshot-graph-button" title="Snapshot" class="btn btn-primary mr-auto">
                    <i class="fa fa-camera"></i>
                </button>
                <button type="button" class="btn btn-secondary" data-dismiss="modal">Continue</button>
            </div>
        </div>
    </div>
</div>
<!-- Show Graph Modal -- END -->

<script>
    // constants used in individual tasks
    const API_URL = "{{url_for('api')}}";
    const SAMPLE_VERSE_DATA_URL = "{{url_for('api_verse', verse_id=0)}}";
    const CURRENT_USERNAME = "{{current_user.username}}";
</script>
<script>
    {% for task in constants.tasks %}
    const TASK_{{task.id}}_SUBMIT_ACTION = "update_{{task.name}}";
    {% endfor %}
</script>
<script src="{{url_for('static', filename='custom/js/corpus/elements.js')}}"></script>
<script src="{{url_for('static', filename='custom/js/corpus/functions.js')}}"></script>
<script src="{{url_for('static', filename='custom/js/corpus/tasks.js')}}"></script>
<script src="{{url_for('static', filename='custom/js/corpus/events.js')}}"></script>

{% include "footer.html" %}